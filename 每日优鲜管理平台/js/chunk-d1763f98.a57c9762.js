(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d1763f98"],{"2d71":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"product-container"},[a("Search",{attrs:{categoryList:t.categoryList},on:{searchSubmit:t.searchSubmit}}),a("a-button",{staticClass:"add-product",on:{click:t.openAddProduct}},[t._v("添加商品")]),a("ProductTable",{attrs:{data:t.data,page:t.page},on:{changePage:t.changePage,editProduct:t.openEditProduct,removeProduct:t.removeProduct}}),a("a-modal",{attrs:{title:t.dialogTitle,"ok-text":t.okText,"cancel-text":"取消",width:"650px"},on:{ok:t.submitProduct},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[a("a-form-model",{ref:"productForm",attrs:{model:t.productForm,rules:t.productRules,layout:"horizontal","label-col":t.labelCol,"wrapper-col":t.wrapperCol}},[a("a-form-model-item",{attrs:{label:"商品标题",prop:"title"}},[a("a-input",{model:{value:t.productForm.title,callback:function(e){t.$set(t.productForm,"title",e)},expression:"productForm.title"}})],1),a("a-form-model-item",{attrs:{label:"商品描述"}},[a("a-input",{attrs:{type:"textarea"},model:{value:t.productForm.desc,callback:function(e){t.$set(t.productForm,"desc",e)},expression:"productForm.desc"}})],1),a("a-form-model-item",{attrs:{label:"商品类目",prop:"category"}},[a("a-select",{attrs:{placeholder:"请选择商品类目"},model:{value:t.productForm.category,callback:function(e){t.$set(t.productForm,"category",e)},expression:"productForm.category"}},t._l(t.categoryList,(function(e){return a("a-select-option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name))])})),1)],1),a("a-form-model-item",{attrs:{label:"商品标签",required:""}},[a("a-input",{model:{value:t.tag,callback:function(e){t.tag=e},expression:"tag"}},[a("a-icon",{attrs:{slot:"suffix",type:"plus-circle"},on:{click:t.addTag},slot:"suffix"})],1),t._l(t.productForm.tags,(function(e,r){return a("span",{key:r,style:t.tagStyle,attrs:{title:"点击删除"},on:{click:function(e){return t.removeTag(r)}}},[t._v(t._s(e))])}))],2),a("a-form-model-item",{attrs:{label:"商品价格",prop:"price"}},[a("a-input-number",{attrs:{min:0},model:{value:t.productForm.price,callback:function(e){t.$set(t.productForm,"price",e)},expression:"productForm.price"}})],1),a("a-form-model-item",{attrs:{label:"商品折扣价",prop:"price_off"}},[a("a-input-number",{attrs:{min:0},model:{value:t.productForm.price_off,callback:function(e){t.$set(t.productForm,"price_off",e)},expression:"productForm.price_off"}})],1),a("a-form-model-item",{attrs:{label:"商品库存量",prop:"inventory"}},[a("a-input-number",{attrs:{min:0},model:{value:t.productForm.inventory,callback:function(e){t.$set(t.productForm,"inventory",e)},expression:"productForm.inventory"}})],1),a("a-form-model-item",{attrs:{label:"商品单位",prop:"unit"}},[a("a-input",{model:{value:t.productForm.unit,callback:function(e){t.$set(t.productForm,"unit",e)},expression:"productForm.unit"}})],1),a("a-form-model-item",{attrs:{label:"是否上架"}},[a("a-switch",{on:{change:t.onChange},model:{value:t.defaultChecked,callback:function(e){t.defaultChecked=e},expression:"defaultChecked"}})],1),a("a-form-item",{attrs:{label:"图片"}},[a("a-upload",{attrs:{action:"https://mallapi.duyiedu.com/upload/images?appkey="+t.$store.state.user.user.appkey,"list-type":"picture-card","file-list":t.fileList,name:"avatar"},on:{change:t.changeImage}},[t.fileList.length<8?a("div",[a("a-icon",{attrs:{type:"plus"}}),a("div",{staticClass:"ant-upload-text"},[t._v("Upload")])],1):t._e()])],1)],1)],1)],1)},o=[],i=a("5530"),s=a("1da1"),n=(a("96cf"),a("d81d"),a("159b"),a("b0c0"),a("4de4"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"search-container"},[a("a-form",{attrs:{layout:"inline",form:t.searchForm},on:{submit:t.handleSubmit}},[a("a-form-item",{attrs:{label:"搜索关键字："}},[a("a-input",{attrs:{placeholder:"请输入关键字"},model:{value:t.searchForm.searchWord,callback:function(e){t.$set(t.searchForm,"searchWord",e)},expression:"searchForm.searchWord"}})],1),a("a-form-item",{attrs:{label:"商品类目："}},[a("a-select",{staticStyle:{width:"200px"},attrs:{"show-search":"",placeholder:"请选择类目","option-filter-prop":"children","filter-option":t.filterOption,allowClear:""},on:{change:t.handleChange}},t._l(t.categoryList,(function(e){return a("a-select-option",{key:e.id,attrs:{value:e.id}},[t._v(" "+t._s(e.name)+" ")])})),1)],1),a("a-form-item",[a("a-button",{attrs:{type:"primary","html-type":"submit"}},[t._v("搜索")])],1)],1)],1)}),c=[],u={props:["categoryList"],data:function(){return{user:this.$store.state.user.user,searchForm:{searchWord:"",category:""}}},methods:{handleChange:function(t){this.searchForm.category=t},handleSubmit:function(){this.$emit("searchSubmit",this.searchForm)},filterOption:function(t,e){return e.componentOptions.children[0].text.toLowerCase().indexOf(t.toLowerCase())>=0}}},l=u,d=(a("b8d1"),a("2877")),p=Object(d["a"])(l,n,c,!1,null,"f5209976",null),m=p.exports,g=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"product-table-container"},[r("a-table",{attrs:{columns:t.columns,"data-source":t.data,pagination:t.page,"row-key":"_id",scroll:{y:"calc(100vh - 230px)"}},on:{change:t.changePage},scopedSlots:t._u([{key:"image",fn:function(t,e){return r("div",{},[r("img",{attrs:{src:e.images[0]?e.images[0]:a("6bcd"),width:"90px",height:"90px",alt:""}})])}},{key:"tags",fn:function(e,a){return r("div",{},t._l(a.tags,(function(e,a){return r("span",{key:a,staticStyle:{"margin-right":"10px"}},[t._v(" "+t._s("【"+e+"】")+" ")])})),0)}},{key:"status",fn:function(e,a){return r("div",{},[t._v(" "+t._s(1===a.status?"已上架":"已下架")+" ")])}},{key:"operation",fn:function(e,a){return r("div",{},[r("a-button",{on:{click:function(e){return t.editProduct(a)}}},[t._v("编辑")]),r("a-button",{on:{click:function(e){return t.removeProduct(a)}}},[t._v("删除")])],1)}}])})],1)},f=[],h=[{title:"图片",scopedSlots:{customRender:"image"}},{dataIndex:"title",title:"标题",ellipsis:!0},{title:"描述",dataIndex:"desc",ellipsis:!0},{title:"类目",dataIndex:"categoryName"},{title:"预售价",dataIndex:"price"},{title:"折扣价",dataIndex:"price_off"},{title:"库存",dataIndex:"inventory"},{title:"标签",scopedSlots:{customRender:"tags"}},{title:"上架状态",scopedSlots:{customRender:"status"}},{title:"操作",scopedSlots:{customRender:"operation"},width:200}],b={props:["data","page"],data:function(){return{columns:h}},methods:{changePage:function(t){this.$emit("changePage",t)},editProduct:function(t){this.$emit("editProduct",t)},removeProduct:function(t){this.$emit("removeProduct",t)}}},v=b,y=Object(d["a"])(v,g,f,!1,null,null,null),F=y.exports,x=a("bb36"),k={get:function(t){return x["a"].get("/products/all",{params:t})},add:function(t){return x["a"].post("/products/add",t)},edit:function(t){return x["a"].put("/products/edit",t)},remove:function(t){return x["a"].delete("/products/".concat(t))}},_=a("c405"),P={data:function(){return{data:[],page:{current:1,total:1,pageSize:10,showSizeChanger:!0},labelCol:{span:6},wrapperCol:{span:14},searchForm:{},categoryList:[],visible:!1,dialogTitle:"",okText:"",dialogStatus:"",tag:"",defaultChecked:!1,tagStyle:{border:"1px solid #ccc",padding:"5px",marginRight:"5px",borderRadius:"5px",cursor:"pointer"},productForm:{title:"",desc:"",category:"",tags:[],price:0,price_off:0,unit:"",status:0,images:[],inventory:0,sale:0},productRules:{title:[{required:!0,message:"请输入商品标题",trigger:"blur"}],category:[{required:!0,message:"请选择商品类目",trigger:"change"}],price:[{required:!0,message:"请输入商品价格",trigger:"blur"}],price_off:[{required:!0,message:"请输入商品折扣价",trigger:"blur"}],unit:[{required:!0,message:"请输入商品单位",trigger:"blur"}],inventory:[{required:!0,message:"请输入商品库存量",trigger:"blur"}]},fileList:[]}},components:{Search:m,ProductTable:F},created:function(){var t=this;_["a"].get().then((function(e){t.categoryList=e.data.data})),this.getTableData()},methods:{searchSubmit:function(t){this.searchForm=t,this.page.current=1,this.getTableData()},getTableData:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,k.get(Object(i["a"])({page:t.page.current,size:t.page.size},t.searchForm));case 2:a=e.sent,t.data=a.data.data.map((function(e,a){var r=e;return t.categoryList.forEach((function(t){r.category===t.id&&(r.categoryName=t.name)})),r})),t.page.total=a.data.total;case 5:case"end":return e.stop()}}),e)})))()},changePage:function(t){this.page=t,this.getTableData()},openAddProduct:function(){this.clearProductForm(),this.dialogTitle="添加商品",this.okText="添加",this.dialogStatus="add",this.visible=!0},submitProduct:function(){var t=this;this.$refs.productForm.validate((function(e){e&&("add"===t.dialogStatus?k.add(t.productForm).then((function(e){"success"===e.status&&(t.$message.success("添加成功"),t.visible=!1,t.getTableData())})):"edit"===t.dialogStatus&&k.edit(t.productForm).then((function(e){"success"===e.status&&(t.$message.success("修改成功"),t.visible=!1,t.getTableData())})))}))},openEditProduct:function(t){this.dialogStatus="edit",this.dialogTitle="编辑商品",this.okText="修改",this.defaultChecked=1===t.status,this.productForm={title:t.title,desc:t.desc,category:t.category,tags:t.tags,price:t.price,price_off:t.price_off,unit:t.unit,status:t.status,images:t.images,inventory:t.inventory,sale:t.sale,_id:t._id,id:t.id},this.fileList=this.productForm.images.map((function(t,e){return{uid:e,name:"image"+e,status:"done",url:t}})),this.visible=!0},removeProduct:function(t){var e=this;this.$confirm({title:"确定删除该商品吗",okText:"确定",cancelText:"取消",onOk:function(){k.remove(t.id).then((function(t){"success"===t.status&&(e.$message.success("删除成功"),e.getTableData())}))}})},addTag:function(){this.tag.length<1||(this.productForm.tags.push(this.tag),this.tag="")},removeTag:function(t){this.productForm.tags=this.productForm.tags.filter((function(e,a){return t!==a}))},onChange:function(t){this.productForm.status=t?1:0},clearProductForm:function(){this.productForm={title:"",desc:"",category:"",tags:[],price:0,price_off:0,unit:"",status:0,images:[],inventory:0,sale:0},this.fileList=[],this.defaultChecked=!1},changeImage:function(t){var e=t.fileList,a=t.file;if("done"===a.status)this.productForm.images.push(a.response.data.url);else if("removed"===a.status){var r=a.url;this.productForm.images=this.productForm.images.filter((function(t){return t!==r}))}this.fileList=e}}},S=P,w=(a("ca32"),Object(d["a"])(S,r,o,!1,null,"f1b1ae40",null));e["default"]=w.exports},"6bcd":function(t,e,a){t.exports=a.p+"img/default.b53ead06.png"},a52a:function(t,e,a){},b8d1:function(t,e,a){"use strict";a("c502")},c405:function(t,e,a){"use strict";var r=a("bb36");e["a"]={get:function(){return r["a"].get("/category/all")},add:function(t){return r["a"].post("/category/add",t)},edit:function(t){return r["a"].put("/category/edit",t)},remove:function(t){return r["a"].delete("/category/".concat(t))}}},c502:function(t,e,a){},ca32:function(t,e,a){"use strict";a("a52a")}}]);
//# sourceMappingURL=chunk-d1763f98.a57c9762.js.map